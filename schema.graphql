"""
An holder account. Can be a user or a contract
"""
type Account {
  """Account address"""
  id: ID!

  """Balances of the account"""
  balances: [TokenBalance!]! @derivedFrom(field: "account")

  """Historical snapshots of the account balances to retrieve balance at specific points in time"""
  snapshots: [TokenBalanceSnapshot!]! @derivedFrom(field: "account")
}


"""
A token is a representation of a fungible asset on the blockchain
as specified by the ERC20 standard.
"""
type Token {
  """token address"""
  id: ID!

  # metadata

  """Is virtual token, we create virtual tokens for the indexer to track non-ERC20 tokens like Beefy Boosts"""
  isVirtual: Boolean!

  """The token symbol"""
  symbol: String
  """The token name"""
  name: String
  """The number of decimals the token uses"""
  decimals: Int!

  ### metrics

  """The total supply of the token"""
  totalSupply: BigDecimal! @config(precision: 100, scale: 24)

  """How many holders this token has. With balance > 0"""
  holderCount: Int!

  ### references

  """The token balances of the token"""
  balances: [TokenBalance!]! @derivedFrom(field: "token")
  """Historical snapshots of the token balance to retrieve balance at specific points in time"""
  snapshots: [TokenBalanceSnapshot!]! @derivedFrom(field: "token")
}

"""
A token balance represents the amount of a specific token that an account holds
"""
type TokenBalance {
  """Account address + Token address"""
  id: ID!

  """The account that holds the token balance"""
  account: Account! @index
  """The token that the account holds"""
  token: Token! @index

  """
  Amount: the amount of the token this account holds.
  This amount is what is available on chain.
  """
  amount: BigDecimal! @config(precision: 100, scale: 24)

  ### references

  """Historical snapshots of the token balance to retrieve balance at specific points in time"""
  snapshots: [TokenBalanceSnapshot!]! @derivedFrom(field: "tokenBalance")
}


"""
A balance snapshot entity to track account balances at specific points in time.
This enables time-travel queries since HyperIndex doesn't support them natively.
One entry is created per transfer event per account.
"""
type TokenBalanceSnapshot {
  """Unique ID: chainId-token-account-blockNumber"""
  id: ID!

  """Token balance reference"""
  tokenBalance: TokenBalance! @index
  """Account ID reference"""
  account: Account!
  """Token ID reference"""
  token: Token!

  """Block number of this snapshot"""
  blockNumber: BigInt! @index
  """Timestamp of this snapshot"""
  blockTimestamp: Timestamp! @index

  """Balance amount at the end of the block"""
  balance: BigDecimal! @config(precision: 100, scale: 24)
}